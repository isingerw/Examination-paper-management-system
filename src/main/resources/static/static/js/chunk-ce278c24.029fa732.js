(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ce278c24"],{"0468":function(e,t,o){"use strict";o.d(t,"b",(function(){return a})),o.d(t,"d",(function(){return n})),o.d(t,"c",(function(){return i})),o.d(t,"a",(function(){return l}));var r=o("b775");function a(e){return Object(r["b"])("/exam/api/repo/detail",e)}function n(e){return Object(r["b"])("/exam/api/repo/save",e)}function i(e){return Object(r["b"])("/exam/api/repo/list",e)}function l(e){return Object(r["b"])("/exam/api/repo/batch-action",e)}},"4ee14":function(e,t,o){"use strict";o.r(t);var r=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"app-container"},[o("el-steps",{attrs:{active:e.step,simple:""}},[o("el-step",{attrs:{title:"组卷配置",icon:"el-icon-set-up"}}),o("el-step",{attrs:{title:"考试权限",icon:"el-icon-unlock"}}),o("el-step",{attrs:{title:"补充配置",icon:"el-icon-s-tools"}})],1),o("div",{staticStyle:{"margin-top":"20px",width:"100%",height:"40px"}},[e.step>1?o("el-button",{on:{click:e.prevStep}},[e._v("上一步")]):e._e(),o("el-button",{staticStyle:{float:"right"},attrs:{type:"primary"},on:{click:e.nextStep}},[e._v(e._s(3===e.step?"提交保存":"下一步"))])],1),1===e.step?o("el-card",{staticStyle:{"margin-top":"20px"}},[o("div",{staticStyle:{float:"right","font-weight":"bold",color:"#ff0000"}},[e._v("试卷总分："+e._s(e.postForm.totalScore)+"分")]),o("div",[o("div",{staticStyle:{"margin-bottom":"20px"}},[o("el-select",{staticClass:"filter-item",attrs:{placeholder:"选择难度等级",clearable:""},model:{value:e.postForm.level,callback:function(t){e.$set(e.postForm,"level",t)},expression:"postForm.level"}},e._l(e.levels,(function(e){return o("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),o("el-button",{staticClass:"filter-item",attrs:{size:"small",type:"primary",icon:"el-icon-plus"},on:{click:e.handleAdd}},[e._v(" 添加题库 ")]),o("el-table",{staticStyle:{width:"100%","margin-top":"15px"},attrs:{data:e.repoList,border:!1,"empty-text":"请点击上面的`添加题库`进行设置"}},[o("el-table-column",{attrs:{label:"题库",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("repo-select",{attrs:{multi:!1},model:{value:t.row.repoId,callback:function(o){e.$set(t.row,"repoId",o)},expression:"scope.row.repoId"}})]}}],null,!1,450928749)}),o("el-table-column",{attrs:{label:"单选数量",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-input-number",{staticStyle:{width:"100%"},attrs:{controls:!1},model:{value:t.row.radioCount,callback:function(o){e.$set(t.row,"radioCount",o)},expression:"scope.row.radioCount"}})]}}],null,!1,3478659297)}),o("el-table-column",{attrs:{label:"单选分数",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-input-number",{staticStyle:{width:"100%"},attrs:{controls:!1},model:{value:t.row.radioScore,callback:function(o){e.$set(t.row,"radioScore",o)},expression:"scope.row.radioScore"}})]}}],null,!1,4171831466)}),o("el-table-column",{attrs:{label:"多选数量",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-input-number",{staticStyle:{width:"100%"},attrs:{controls:!1},model:{value:t.row.multiCount,callback:function(o){e.$set(t.row,"multiCount",o)},expression:"scope.row.multiCount"}})]}}],null,!1,1434325145)}),o("el-table-column",{attrs:{label:"多选分数",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-input-number",{staticStyle:{width:"100%"},attrs:{controls:!1},model:{value:t.row.multiScore,callback:function(o){e.$set(t.row,"multiScore",o)},expression:"scope.row.multiScore"}})]}}],null,!1,442354770)}),o("el-table-column",{attrs:{label:"判断题数量",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-input-number",{staticStyle:{width:"100%"},attrs:{controls:!1},model:{value:t.row.judgeCount,callback:function(o){e.$set(t.row,"judgeCount",o)},expression:"scope.row.judgeCount"}})]}}],null,!1,718431913)}),o("el-table-column",{attrs:{label:"判断题分数",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-input-number",{staticStyle:{width:"100%"},attrs:{controls:!1},model:{value:t.row.judgeScore,callback:function(o){e.$set(t.row,"judgeScore",o)},expression:"scope.row.judgeScore"}})]}}],null,!1,3693218402)}),o("el-table-column",{attrs:{label:"删除",align:"center",width:"80px"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(o){return e.removeItem(t.$index)}}})]}}],null,!1,1518468532)})],1)],1)]):e._e(),2===e.step?o("el-card",{staticStyle:{"margin-top":"20px"}},[o("el-radio-group",{staticStyle:{"margin-bottom":"20px"},model:{value:e.postForm.openType,callback:function(t){e.$set(e.postForm,"openType",t)},expression:"postForm.openType"}},[o("el-radio",{attrs:{label:1,border:""}},[e._v("完全公开")]),o("el-radio",{attrs:{label:2,border:""}},[e._v("部门开放")])],1),1===e.postForm.openType?o("el-alert",{attrs:{title:"开放的，任何人都可以进行考试！",type:"warning"}}):e._e(),2===e.postForm.openType?o("div",[o("el-input",{attrs:{placeholder:"输入关键字进行过滤"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}}),o("el-tree",{directives:[{name:"loading",rawName:"v-loading",value:e.treeLoading,expression:"treeLoading"}],ref:"tree",attrs:{"empty-text":" ",data:e.treeData,"default-expand-all":"","show-checkbox":"","node-key":"id","default-checked-keys":e.postForm.departIds,props:e.defaultProps,"filter-node-method":e.filterNode},on:{"check-change":e.handleCheckChange}})],1):e._e()],1):e._e(),3===e.step?o("el-card",{staticStyle:{"margin-top":"20px"}},[o("el-form",{ref:"postForm",attrs:{model:e.postForm,rules:e.rules,"label-position":"left","label-width":"120px"}},[o("el-form-item",{attrs:{label:"考试名称",prop:"title"}},[o("el-input",{model:{value:e.postForm.title,callback:function(t){e.$set(e.postForm,"title",t)},expression:"postForm.title"}})],1),o("el-form-item",{attrs:{label:"考试描述",prop:"content"}},[o("el-input",{attrs:{type:"textarea"},model:{value:e.postForm.content,callback:function(t){e.$set(e.postForm,"content",t)},expression:"postForm.content"}})],1),o("el-form-item",{attrs:{label:"总分数",prop:"totalScore"}},[o("el-input-number",{attrs:{value:e.postForm.totalScore,disabled:""}})],1),o("el-form-item",{attrs:{label:"及格分",prop:"qualifyScore"}},[o("el-input-number",{attrs:{max:e.postForm.totalScore},model:{value:e.postForm.qualifyScore,callback:function(t){e.$set(e.postForm,"qualifyScore",t)},expression:"postForm.qualifyScore"}})],1),o("el-form-item",{attrs:{label:"考试时长(分钟)",prop:"totalTime"}},[o("el-input-number",{model:{value:e.postForm.totalTime,callback:function(t){e.$set(e.postForm,"totalTime",t)},expression:"postForm.totalTime"}})],1),o("el-form-item",{attrs:{label:"是否限时"}},[o("el-checkbox",{model:{value:e.postForm.timeLimit,callback:function(t){e.$set(e.postForm,"timeLimit",t)},expression:"postForm.timeLimit"}})],1),e.postForm.timeLimit?o("el-form-item",{attrs:{label:"考试时间",prop:"totalTime"}},[o("el-date-picker",{attrs:{format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",type:"daterange","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间"},model:{value:e.dateValues,callback:function(t){e.dateValues=t},expression:"dateValues"}})],1):e._e()],1)],1):e._e()],1)},a=[],n=(o("ac6a"),o("bd86")),i=o("955d"),l=o("9b73"),s=o("4a02"),u={name:"ExamDetail",components:{RepoSelect:s["a"]},data:function(){var e;return{step:1,treeData:[],defaultProps:{label:"deptName"},levels:[{value:0,label:"不限"},{value:1,label:"普通"},{value:2,label:"较难"}],filterText:"",treeLoading:!1,dateValues:[],quDialogShow:!1,quDialogType:1,excludes:[],scoreDialog:!1,scoreBatch:0,repoList:[],quList:[[],[],[],[]],quEnable:[!1,!1,!1,!1],postForm:{totalScore:0,repoList:[],quList:[],joinType:1,openType:1,departIds:[]},rules:(e={title:[{required:!0,message:"考试名称不能为空！"}],content:[{required:!0,message:"考试名称不能为空！"}],open:[{required:!0,message:"考试权限不能为空！"}],totalScore:[{required:!0,message:"考试分数不能为空！"}],qualifyScore:[{required:!0,message:"及格分不能为空！"}],totalTime:[{required:!0,message:"考试时间不能为空！"}]},Object(n["a"])(e,"content",[{required:!0,message:"课程描述不能为空"}]),Object(n["a"])(e,"ruleId",[{required:!0,message:"考试规则不能为空"}]),Object(n["a"])(e,"password",[{required:!0,message:"考试口令不能为空！"}]),e)}},watch:{filterText:function(e){this.$refs.tree.filter(e)},dateValues:{handler:function(){this.postForm.startTime=this.dateValues[0],this.postForm.endTime=this.dateValues[1]}},repoList:{handler:function(){var e=this;e.postForm.totalScore=0,this.repoList.forEach((function(t){e.postForm.totalScore+=t.radioCount*t.radioScore,e.postForm.totalScore+=t.multiCount*t.multiScore,e.postForm.totalScore+=t.judgeCount*t.judgeScore})),this.postForm.repoList=this.repoList},deep:!0}},created:function(){var e=this,t=this.$route.params.id;"undefined"!==typeof t&&this.fetchData(t),Object(l["c"])({}).then((function(t){e.treeData=t.data}))},methods:{nextStep:function(){var e=this;this.step<3?this.step+=1:this.$refs.postForm.validate((function(t){if(t)if(0!==e.postForm.totalScore){if(1===e.postForm.joinType)for(var o=0;o<e.postForm.repoList.length;o++){var r=e.postForm.repoList[o];if(!r.repoId)return void e.$notify({title:"提示信息",message:"考试题库选择不正确！",type:"warning",duration:2e3});if(r.radioCount>0&&0===r.radioScore||0===r.radioCount&&r.radioScore>0)return void e.$notify({title:"提示信息",message:"题库第：["+(o+1)+"]项存在无效的单选题配置！",type:"warning",duration:2e3});if(r.multiCount>0&&0===r.multiScore||0===r.multiCount&&r.multiScore>0)return void e.$notify({title:"提示信息",message:"题库第：["+(o+1)+"]项存在无效的多选题配置！",type:"warning",duration:2e3});if(r.judgeCount>0&&0===r.judgeScore||0===r.judgeCount&&r.judgeScore>0)return void e.$notify({title:"提示信息",message:"题库第：["+(o+1)+"]项存在无效的判断题配置！",type:"warning",duration:2e3})}e.$confirm("确实要提交保存吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.submitForm()}))}else e.$notify({title:"提示信息",message:"考试规则设置不正确，请确认！",type:"warning",duration:2e3})}))},prevStep:function(){this.step-=1},handleCheckChange:function(){var e=this;this.postForm.departIds=[];var t=this.$refs.tree.getCheckedNodes();t.forEach((function(t){e.postForm.departIds.push(t.id)}))},handleAdd:function(){this.repoList.push({radioCount:0,radioScore:0,multiCount:0,multiScore:0,judgeCount:0,judgeScore:0,saqCount:0,saqScore:0})},removeItem:function(e){this.repoList.splice(e,1)},fetchData:function(e){var t=this,o=this;Object(i["a"])(e).then((function(e){t.postForm=e.data,t.dateValues[0]=t.postForm.startTime,t.dateValues[1]=t.postForm.endTime,2===t.postForm.joinType&&t.postForm.quList.forEach((function(e){var t=e.quType-1;o.quList[t].push(e),o.quEnable[t]=!0})),1===t.postForm.joinType&&(o.repoList=o.postForm.repoList)}))},submitForm:function(){var e=this;this.postForm.repoList=this.repoList,Object(i["c"])(this.postForm).then((function(){e.$notify({title:"成功",message:"考试保存成功！",type:"success",duration:2e3}),e.$router.push({name:"ListExam"})}))},filterNode:function(e,t){return!e||-1!==t.deptName.indexOf(e)}}},c=u,p=o("2877"),d=Object(p["a"])(c,r,a,!1,null,"fc6796ee",null);t["default"]=d.exports},"955d":function(e,t,o){"use strict";o.d(t,"a",(function(){return a})),o.d(t,"c",(function(){return n})),o.d(t,"b",(function(){return i}));var r=o("b775");function a(e){return Object(r["b"])("/exam/api/exam/exam/detail",{id:e})}function n(e){return Object(r["b"])("/exam/api/exam/exam/save",e)}function i(){return Object(r["b"])("/exam/api/exam/exam/paging",{current:1,size:100})}},"9b73":function(e,t,o){"use strict";o.d(t,"d",(function(){return a})),o.d(t,"c",(function(){return n})),o.d(t,"b",(function(){return i})),o.d(t,"a",(function(){return l})),o.d(t,"e",(function(){return s})),o.d(t,"f",(function(){return u}));var r=o("b775");function a(e){return Object(r["b"])("/exam/api/sys/depart/paging",e)}function n(e){return Object(r["b"])("/exam/api/sys/depart/tree",e)}function i(e){var t={id:e};return Object(r["b"])("/exam/api/sys/depart/detail",t)}function l(e){var t={ids:e};return Object(r["b"])("/exam/api/sys/depart/delete",t)}function s(e){return Object(r["b"])("/exam/api/sys/depart/save",e)}function u(e,t){var o={id:e,sort:t};return Object(r["b"])("/exam/api/sys/depart/sort",o)}}}]);